<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# otelcourier

```go
import "github.com/gojek/courier-go/otelcourier"
```

Package otelcourier instruments the github.com/gojek/courier\-go package.

## Index

- [Constants](<#constants>)
- [func DisableCallbackTracing(opts *traceOptions)](<#func-disablecallbacktracing>)
- [func DisablePublisherTracing(opts *traceOptions)](<#func-disablepublishertracing>)
- [func DisableSubscriberTracing(opts *traceOptions)](<#func-disablesubscribertracing>)
- [func DisableUnsubscriberTracing(opts *traceOptions)](<#func-disableunsubscribertracing>)
- [type Option](<#type-option>)
  - [func WithTextMapCarrierExtractFunc(fn func(context.Context) propagation.TextMapCarrier) Option](<#func-withtextmapcarrierextractfunc>)
  - [func WithTextMapPropagator(propagator propagation.TextMapPropagator) Option](<#func-withtextmappropagator>)
  - [func WithTracerProvider(provider oteltrace.TracerProvider) Option](<#func-withtracerprovider>)
- [type Tracer](<#type-tracer>)
  - [func NewTracer(service string, opts ...Option) *Tracer](<#func-newtracer>)
  - [func (t *Tracer) ApplyTraceMiddlewares(c *courier.Client)](<#func-tracer-applytracemiddlewares>)
  - [func (t *Tracer) PublisherMiddleware(next courier.Publisher) courier.Publisher](<#func-tracer-publishermiddleware>)
  - [func (t *Tracer) SubscriberMiddleware(next courier.Subscriber) courier.Subscriber](<#func-tracer-subscribermiddleware>)
  - [func (t *Tracer) UnsubscriberMiddleware(next courier.Unsubscriber) courier.Unsubscriber](<#func-tracer-unsubscribermiddleware>)


## Constants

```go
const (
    // MQTTTopic is the attribute key for tracing message topic
    MQTTTopic = attribute.Key("mqtt.topic")
    // MQTTQoS is the attribute key for tracing message qos
    MQTTQoS = attribute.Key("mqtt.qos")
    // MQTTTopicWithQoS is the attribute key for tracing message topic and qos together
    MQTTTopicWithQoS = attribute.Key("mqtt.topicwithqos")
    // MQTTRetained is the attribute key for tracing message retained flag
    MQTTRetained = attribute.Key("mqtt.retained")
)
```

## func [DisableCallbackTracing](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L59>)

```go
func DisableCallbackTracing(opts *traceOptions)
```

DisableCallbackTracing disables implicit tracing on subscription callbacks.

## func [DisablePublisherTracing](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L62>)

```go
func DisablePublisherTracing(opts *traceOptions)
```

DisablePublisherTracing disables courier.Publisher tracing.

## func [DisableSubscriberTracing](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L65>)

```go
func DisableSubscriberTracing(opts *traceOptions)
```

DisableSubscriberTracing disables courier.Subscriber tracing.

## func [DisableUnsubscriberTracing](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L68>)

```go
func DisableUnsubscriberTracing(opts *traceOptions)
```

DisableUnsubscriberTracing disables courier.Unsubscriber tracing.

## type [Option](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L30>)

Option helps configure trace options.

```go
type Option func(*traceOptions)
```

### func [WithTextMapCarrierExtractFunc](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L54>)

```go
func WithTextMapCarrierExtractFunc(fn func(context.Context) propagation.TextMapCarrier) Option
```

WithTextMapCarrierExtractFunc is used to specify the function which should be used to extract propagation.TextMapCarrier from the ongoing context.Context.

### func [WithTextMapPropagator](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L48>)

```go
func WithTextMapPropagator(propagator propagation.TextMapPropagator) Option
```

WithTextMapPropagator specifies the propagator to use for extracting/injecting key\-value texts. If none is specified, the global provider is used.

### func [WithTracerProvider](<https://github.com/gojek/courier-go/blob/main/otelcourier/options.go#L42>)

```go
func WithTracerProvider(provider oteltrace.TracerProvider) Option
```

WithTracerProvider specifies a tracer provider to use for creating a tracer. If none is specified, the global provider is used.

## type [Tracer](<https://github.com/gojek/courier-go/blob/main/otelcourier/trace.go#L17-L23>)

Tracer implements tracing abilities using OpenTelemetry SDK.

```go
type Tracer struct {
    // contains filtered or unexported fields
}
```

### func [NewTracer](<https://github.com/gojek/courier-go/blob/main/otelcourier/trace.go#L26>)

```go
func NewTracer(service string, opts ...Option) *Tracer
```

NewTracer creates a new Tracer with Option\(s\).

<details><summary>Example</summary>
<p>

```go
package main

import (
	"context"
	courier "github.com/gojek/courier-go"
	"github.com/gojek/courier-go/otelcourier"
	"go.opentelemetry.io/otel"
	"go.opentelemetry.io/otel/sdk/trace"
	"os"
	"os/signal"
	"syscall"
)

func main() {
	tp := trace.NewTracerProvider()
	defer tp.Shutdown(context.Background())

	otel.SetTracerProvider(tp)

	c, _ := courier.NewClient()
	otelcourier.NewTracer("service-name").ApplyTraceMiddlewares(c)

	if err := c.Start(); err != nil {
		panic(err)
	}

	stopCh := make(chan os.Signal, 1)
	signal.Notify(stopCh, []os.Signal{os.Interrupt, syscall.SIGTERM}...)

	if err := c.Publish(
		context.Background(), "test-topic", "message", courier.QOSOne); err != nil {
		panic(err)
	}
	<-stopCh

	c.Stop()
}
```

</p>
</details>

### func \(\*Tracer\) [ApplyTraceMiddlewares](<https://github.com/gojek/courier-go/blob/main/otelcourier/trace.go#L49>)

```go
func (t *Tracer) ApplyTraceMiddlewares(c *courier.Client)
```

ApplyTraceMiddlewares will instrument all the operations of a courier.Client instance according to Option\(s\) used.

### func \(\*Tracer\) [PublisherMiddleware](<https://github.com/gojek/courier-go/blob/main/otelcourier/publish.go#L20>)

```go
func (t *Tracer) PublisherMiddleware(next courier.Publisher) courier.Publisher
```

PublisherMiddleware is a courier.PublisherMiddlewareFunc for tracing publish calls.

### func \(\*Tracer\) [SubscriberMiddleware](<https://github.com/gojek/courier-go/blob/main/otelcourier/subscribe.go#L25>)

```go
func (t *Tracer) SubscriberMiddleware(next courier.Subscriber) courier.Subscriber
```

SubscriberMiddleware is a courier.SubscriberMiddlewareFunc for tracing subscribe calls.

### func \(\*Tracer\) [UnsubscriberMiddleware](<https://github.com/gojek/courier-go/blob/main/otelcourier/unsubscribe.go#L19>)

```go
func (t *Tracer) UnsubscriberMiddleware(next courier.Unsubscriber) courier.Unsubscriber
```

UnsubscriberMiddleware is a courier.UnsubscriberMiddlewareFunc for tracing unsubscribe calls.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
